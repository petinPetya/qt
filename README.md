# Яндекс лицей 2025, PyQT6

# Архитектура PyQt6 редактора изображений с базой данных и OCR

---

## Общий обзор архитектуры

- **Основной класс**: `PaintApp` (`QMainWindow`)
- **Ключевые модули**:
  - GUI-интерфейс (вкладки, холст, инструменты)
  - Система авторизации (Login/Register)
  - Работа с изображениями (фильтры, каналы)
  - Хранение работ в БД (SQLAlchemy)
  - OCR-модуль (Tesseract + многопоточность)
- **Технологии**: PyQt6, SQLAlchemy, PIL, pytesseract, SQLite/PostgreSQL

---

## Иерархия классов

- **GUI**:
  - `PaintApp` — главный контроллер
  - `Canvas`, `FixedGraphicsScene`, `CustomGraphicsView` — рендеринг и ввод
- **БД**:
  - `User`, `Work` — модели SQLAlchemy
- **Авторизация**:
  - `Login`, `Register` — диалоги (`QDialog`)
- **OCR**:
  - `OCRThread` — фоновый поток (`QThread`)

---

## Модель `User`

**Таблица**: `users`

| Поле | Тип | Описание |
|------|-----|---------|
| `id` | INTEGER | Первичный ключ |
| `name` | VARCHAR(50) | Уникальное имя |
| `name_normalized` | VARCHAR(50) | Нижний регистр для поиска |
| `email` | VARCHAR(100) | Уникальный email |
| `password` | VARCHAR(30) | Хэш пароля |

**Валидации**:
- Email — формат
- Имя — не начинается с цифры/символа
- Пароль — ≥6 символов

---

## Модель `Work`

**Таблица**: `works`

| Поле | Тип | Описание |
|------|-----|---------|
| `id` | INTEGER | Первичный ключ |
| `name` | VARCHAR(50) | Название работы |
| `name_normalized` | VARCHAR(50) | Для поиска |
| `description` | TEXT | Описание |
| `creator_id` | INTEGER | FK → `users.id` |
| `created_at` | DATETIME | Время создания |
| `image_data` | LargeBinary | Изображение в байтах |
| `image_filename` | VARCHAR(255) | Оригинальное имя файла |

**Связь**: Один пользователь → много работ

---

## Работа с изображениями

- Загрузка: `QFileDialog` → PIL → `QPixmap`
- Редактирование:
  - Кисть (цвет, толщина)
  - Фильтры: размытие, контраст, каналы (RGB)
- Сохранение:
  - На диск (PNG/JPG)
  - В БД как `LargeBinary`
- Поддержка отмены действий (undo/redo — опционально)

---

## OCR-модуль

- **Класс**: `OCRThread` (наследует `QThread`)
- **Библиотека**: `pytesseract`
- **Потокобезопасность**: сигналы/слоты PyQt
- **Интеграция**:
  - Пользователь выделяет область → отправка в поток → результат в текстовое поле
- Обработка ошибок: отсутствие Tesseract, пустое изображение

---

## Итоги

✅ Полнофункциональный графический редактор  
✅ Безопасная авторизация и управление пользователями  
✅ Хранение работ в реляционной БД  
✅ Расширенная обработка изображений  
✅ Интеграция OCR в интерфейс  
✅ Готовность к экспорту в PDF / печати

> Архитектура масштабируема и поддерживает расширение функционала (слои, экспорт в PDF, облако и др.)
